<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Variables &amp; Functions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="default.css" rel="stylesheet" type="text/css">
</head>
<body>
<h1 id="variables-&amp;-functions">Variables &amp; Functions</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#Built-in-Variables">Built-in Variables</a></li>
<li><a href="#Using-Variables-In-Playback">Using Variables In Playback</a></li>
<li><a href="#Assigning-And-Comparing-Variables">Assigning And Comparing Variables</a></li>
<li><a href="#Dynamic-Variable-References">Dynamic Variable References</a></li>
<li><a href="#Using-Functions-In-Playback">Using Functions In Playback</a></li>
<li><a href="#Eval">Eval()</a></li>
</ul>
<h2 id="built-in-variables">Built-in Variables</h2>
<p>Built-in Variables can be used inside the program to reference dynamic information. A list of these Variables with their description can be found in the <a href="http://l.autohotkey.net/docs/Variables.htm#BuiltIn">AutoHotkey documentation</a>.</p>
<h2 id="using-variables-in-playback">Using Variables In Playback</h2>
<p>Any single word enclosed in percent signs (e.g. <em>%MyVar%</em>) inside a string in the Details, Control and Window columns will be converted to the variable's contents during playback. That means you can use variables in <em>Text</em> or <em>MsgBox</em> and other commands. For example you can copy a text and send it using <em>ControlSend</em> or <em>ControlSetText</em> directly from the clipboard.</p>
<pre class="NoIndent">Today is %A_DDDD% and it's %A_Hour%:%A_Min%.
Clipboard's contents are: %Clipboard%</pre>
<p>Download Example: <a href="Examples\Variables.pmc">Using Variables inside Command Parameters</a>.</p>
<h2 id="assigning-and-comparing-variables">Assigning And Comparing Variables</h2>
<p>To create or modify a Variable click in the <em>If</em> button and the <em>Assign Variable</em> tab, type a valid variable name, select one of the operators and a value.</p>
<pre class="NoIndent">MyVar := Some Text
Counter += 1
NewVar := %MyVar% and some text.</pre>
<p>The option <em>Use Eval() to solve expressions</em> allows you to use the Eval() function (more info at the bottom of this page) to solve math expressions during assingment so that the variable's contents will be the result of the operation.</p>
<pre class="NoIndent">MyVar := 30 * 100 / 200 <em>; This would assign 15 to MyVar</em>
MyVar := %Number% + 100 <em>; This would assign the value from variable Number + 100 to MyVar</em></pre>
<p>To compare variables click the <em>If</em> button and the <em>If Statements</em> tab, you may select <em>Evaluate Expression</em> to test any valid expresssion or select <em>Compare Variables</em> in the dropdown list. In the edit box you can enter a valid syntax to create the If Statement for comparing such as:</p>
<pre class="NoIndent">MyVar = 5
Clipboard &gt; %MyVar%</pre>
<p>The operators accepted are:</p>
<pre class="NoIndent">= == &lt;&gt; != &gt; &lt; &gt;= &lt;=</pre>
<p>Download Example: <a href="Examples\CompareVars.pmc">Comparing Variables in Playback</a>.</p>
<p><em>Note</em>: The <em>Compare Variables</em> options is limited to two arguments, <em>Evaluate Expression</em> uses the <em>Eval()</em> function so is more flexible. For <em>Evaluate Expression</em> all variables must be enclosed in percent signs.</p>
<h3 id="remarks">Remarks</h3>
<p>In order to assign variables values to other variables (e.g. <em>MyVar := Clipboard</em>) you will have to use percent signs even though it's not the correct syntax for AHK, so the program will show <em>MyVar := %Clipboard%</em> in details but it will correct the syntax for exported scripts.</p>
<p>The exported script (as well as the preview window) will auto correct <em>MyVar := %Clipboard%</em> to <em>MyVar := Clipboard</em> and <em>MyVar := Clipboard</em> to <em>MyVar := &quot;Clipboard&quot;</em>. It should also correct the combination of both Vars and Strings like <em>MyVar := Today is %A_DDD%</em> to <em>MyVar := &quot;Today is &quot; A_DDD</em> EXCEPT when using the <em>Eval()</em> option in which case only math expressions and variables should be used.</p>
<h3 id="boolean-assignment">Boolean Assignment</h3>
<p>To switch a variable's value True &lt;&gt; False use an exclamation in from of the value. Variable must be enclosed in percent signs.</p>
<pre class="NoIndent">MyVar := !%MyVar%</pre>
<h2 id="dynamic-variable-references">Dynamic Variable References</h2>
<p><em>From AutoHotkey Help File</em>:<br/>
<strong>Force an expression</strong>: An expression can be used in a parameter that does not directly support it (except an OutputVar or InputVar parameter such as those of StringLen) by preceding the expression with a percent sign and a space or tab. If a variable is enclosed in percent signs within an expression (e.g. <em>%Var%</em>), whatever that variable contains is assumed to be the name or partial name of another variable (if there is no such variable, %Var% resolves to a blank string). This is most commonly used to reference pseudo-array elements such as the following example:</p>
<pre class="NoIndent">FileAppend, % MyArray%i%, My File.txt</pre>
<p>Although <strong>Macro Creator doesn't actually supports Expressions</strong> in the same way it uses this method to reference a Dynamic Variable (or a Function Call) and access arrays (such as the ones created by StringSplit) in command's parameters as well.<br/>
<em>Note</em>: Field must start with &quot;% &quot; and must contain only ONE reference.</p>
<p>Download Example: <a href="Examples\DynamicVars.pmc">Accessing a Pseudo-Array inside Command Parameters</a>.</p>
<h2 id="using-functions-in-playback">Using Functions In Playback</h2>
<p>Similarly to Variables it's also possible to use built-In Function results in Playback. To use a Function Call inside a command's parameter you have to use the same method as Dynamic Variables by preceding each Function with a percent sign and a space or tab.<br/></p>
<pre class="NoIndent">% StrLen(Some Text)
% SubStr(%MyVar%, 3, 7)
Result is: % RegExReplace(%Variable%, _, %A_Space%)</pre>
<p><em>Notes</em>:<br/></p>
<ul>
<li>Since Playback uses a function to dereference variables before assigning, variables references should be enclosed in percent signs. The syntax will be corrected for the exported script.  </li>
<li>Literal commas should be escaped.  </li>
</ul>
<pre class="NoIndent">% SubStr(This is`, a literal comma, 13)</pre>
<ul>
<li>It's not necessary to use &quot;quotes&quot; for string parameters EXCEPT for blank parameters.  </li>
<li>Omitted parameters will use their default values just like a normal Function Call.  </li>
</ul>
<p>Download Example: <a href="Examples\Functions.pmc">Using Functions inside Command Parameters</a>.</p>
<h3 id="remarks">Remarks</h3>
<p>Because <strong>Macro Creator</strong> uses a function that recognizes patterns using RegExMatch in order to convert Variables and Functions to their results it will allow some non-standard usage of Function Calls like in this example:</p>
<pre class="NoIndent">% SubStr(AutoHotkey, 1, 1)% SubStr(AutoHotkey, 5, 1)K</pre>
<p>If you put this into a Message Box command for Playback it will show &quot;AHK&quot;, but the generated AHK script for this (in Preview or Export) would throw an error when you run it from an .ahk file since it has two leading percent signs and the K should be enclosed in quotes to be recognized as a string and not a variable.</p>
<h2 id="eval">Eval()</h2>
<p><strong>Eval()</strong> is a function written by <strong>Laszlo</strong> to solve Math Expressions in Strings. It can be found at AHK Forum <a href="http://www.autohotkey.com/board/topic/15675-monster">Monster: evaluate math expressions in strings</a>.</p>
<p>This function has been integrated into <strong>Macro Creator</strong> to allow it to solve math expressions when assigning variables during playback (if Use Eval() option is enabled).</p>
<p><strong>Example</strong>: When you use the Image Search (or Pixel Search) command, the found coordinates are saved to the variables <em>%FoundX%</em> and <em>%FoundY%</em> that would point to the top-left corner of the image.<br/>
Now suppose we want to move the mouse 100 pixels right and 100 pixels down to click on an offset from the image position (Mouse coordinates accept variables). Without this function you'd have to first assign new variables:</p>
<pre class="NoIndent">NewVarX := %FoundX%
NewVarY := %FoundY%</pre>
<p>And then add another assignment for those variables with:</p>
<pre class="NoIndent">NewVarX += 100
NewVarY += 100</pre>
<p>If you check the <em>Use Eval()</em> option you can use the following directly in the first assignments to get the same results:</p>
<pre class="NoIndent">NewVarX := %FoundX% + 100
NewVarX := %FoundY% + 100</pre>
<p>The <a href="Examples\Variables.pmc">Variables Example</a> has a demonstration of this usage.</p>
<p><strong>Eval()</strong> can also be used inside command parameters as described in Functions.</p>
</body>
</html>